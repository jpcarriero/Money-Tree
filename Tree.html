<!DOCTYPE HTML>
<html>

<head>
<meta charset="UTF-8">
<title>Canvas Animated Tree</title>
<style type="text/css">
* {
  margin: 0; padding: 0;
}
#canvas {
  display: block;
}

</style>

<body>
	
<canvas id="canvas"></canvas>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
	

<script type="text/javascript">
var integrations = {
	  "JackDB":"integration-jackdb",
	  "Attribution":"integration-attribution",
	  "Facebook Custom Audiences":"integration-facebook-custom-audiences",
	  "Mode":"integration-mode",
	  "Chartio":"integration-chartio",
	  "Development":"integration-development",
	  "Bronto":"integration-bronto",
	  "Crazy Egg":"integration-crazy-egg",
	  "Email Aptitude":"integration-email-aptitude",
	  "Heap":"integration-heap",
	  "SaaSquatch":"integration-saasquatch",
	  "Lifecycle":"integration-lifecycle",
	  "FullStory":"integration-fullstory",
	  "Omniture":"integration-omniture",
	  "Bing Ads":"integration-bing-ads",
	  "Improvely":"integration-improvely",
	  "Frontleaf":"integration-frontleaf",
	  "Stitch":"integration-stitch",
	  "Appboy":"integration-appboy",
	  "Whale Watch":"integration-whale-watch",
	  "Whale Alerts":"integration-whale-alerts",
	  "Treasure Data":"integration-treasure-data",
	  "Mailjet":"integration-mailjet",
	  "HasOffers":"integration-hasoffers",
	  "Crittercism":"integration-crittercism",
	  "Apptimize":"integration-apptimize",
	  "Autosend":"integration-autosend",
	  "awe.sm":"integration-awe.sm",
	  "Clicky":"integration-clicky",
	  "Elevio":"integration-elevio",
	  "Evergage":"integration-evergage",
	  "Facebook Conversion Tracking":"integration-facebook-conversion-tracking",
	  "FoxMetrics":"integration-foxmetrics",
	  "Inspectlet":"integration-inspectlet",
	  "Navilytics":"integration-navilytics",
	  "Route":"integration-route",
	  "SupportHero":"integration-supporthero",
	  "TV Squared":"integration-tv-squared",
	  "Userlike":"integration-userlike",
	  "WebEngage":"integration-webengage",
	  "Totango":"integration-totango",
	  "Zendesk":"integration-zendesk",
	  "Calq":"integration-calq",
	  "Drip":"integration-drip",
	  "Gainsight":"integration-gainsight",
	  "Iron.io":"integration-iron.io",
	  "Kenshoo":"integration-kenshoo",
	  "Get Satisfaction":"integration-get-satisfaction",
	  "Olark":"integration-olark",
	  "SparkPost":"integration-sparkpost",
	  "Salesmachine":"integration-salesmachine",
	  "Machinify":"integration-machinify",
	  "Keen IO":"integration-keen-io",
	  "MailChimp":"integration-mailchimp",
	  "Periscope.io":"integration-periscope.io",
	  "Xplenty":"integration-xplenty",
	  "Extole":"integration-extole",
	  "Sendwithus":"integration-sendwithus",
	  "Looker":"integration-looker",
	  "Yellowhammer":"integration-yellowhammer",
	  "Salesforce Marketing Cloud":"integration-salesforce-marketing-cloud",
	  "Selligent":"integration-selligent",
	  "Appcues":"integration-appcues",
	  "Kilometer.io":"integration-kilometer.io",
	  "HelloWorld":"integration-helloworld",
	  "Ambassador":"integration-ambassador",
	  "Lucky Orange":"integration-lucky-orange",
	  "Parsely":"integration-parsely",
	  "Cordial":"integration-cordial",
	  "Google Analytics":"integration-google-analytics",
	  "UserVoice":"integration-uservoice",
	  "Tableau":"integration-tableau",
	  "Zopim":"integration-zopim",
	  "Freshdesk":"integration-freshdesk",
	  "ClientSuccess":"integration-clientsuccess",
	  "Convertro":"integration-convertro",
	  "GoSquared":"integration-gosquared",
	  "AdRoll":"integration-adroll",
	  "Chango":"integration-chango",
	  "Infinario":"integration-infinario",
	  "Rubicon Project":"integration-rubicon-project",
	  "Aboardly":"integration-aboardly",
	  "Planhat":"integration-planhat",
	  "Webtrends":"integration-webtrends",
	  "MediaMath":"integration-mediamath",
	  "Flurry":"integration-flurry",
	  "MoEngage":"integration-moengage",
	  "Tapstream":"integration-tapstream",
	  "Bugsnag":"integration-bugsnag",
	  "Localytics":"integration-localytics",
	  "AdLearn Open Platform":"integration-adlearn-open-platform",
	  "Adometry":"integration-adometry",
	  "AdWords":"integration-google-adwords",
	  "Alexa":"integration-alexa",
	  "AppNexus":"integration-appnexus",
	  "Atatus":"integration-atatus",
	  "Blueshift":"integration-blueshift",
	  "BugHerd":"integration-bugherd",
	  "Curebit":"integration-curebit",
	  "Eloqua":"integration-eloqua",
	  "Errorception":"integration-errorception",
	  "Gauges":"integration-gauges",
	  "Google Tag Manager":"integration-google-tag-manager",
	  "Hello Bar":"integration-hello-bar",
	  "HitTail":"integration-hittail",
	  "HubSpot":"integration-hubspot",
	  "QuanticMind":"integration-quanticmind",
	  "KISSmetrics":"integration-kissmetrics",
	  "LiveChat":"integration-livechat",
	  "Marketo":"integration-marketo",
	  "Monetate":"integration-monetate",
	  "MouseStats":"integration-mousestats",
	  "Nudgespot":"integration-nudgespot",
	  "Optimizely":"integration-optimizely",
	  "Outbound":"integration-outbound",
	  "Perfect Audience":"integration-perfect-audience",
	  "Pingdom":"integration-pingdom",
	  "Piwik":"integration-piwik",
	  "Preact":"integration-preact",
	  "Qualaroo":"integration-qualaroo",
	  "Quantcast":"integration-quantcast",
	  "Rocket Fuel":"integration-rocket-fuel",
	  "ShareASale":"integration-shareasale",
	  "SnapEngage":"integration-snapengage",
	  "Spinnakr":"integration-spinnakr",
	  "Steelhouse":"integration-steelhouse",
	  "Taplytics":"integration-taplytics",
	  "Track JS":"integration-track-js",
	  "Twitter Ads":"integration-twitter-ads",
	  "Vero":"integration-vero",
	  "Visual Website Optimizer":"integration-visual-website-optimizer",
	  "Woopra":"integration-woopra",
	  "Yandex Metrica":"integration-yandex-metrica",
	  "Ramen":"integration-ramen",
	  "SimpleReach":"integration-simplereach",
	  "DataXu":"integration-dataxu",
	  "Millennial Media":"integration-millennial-media",
	  "New Relic":"integration-new-relic",
	  "Rockerbox":"integration-rockerbox",
	  "Pardot":"integration-pardot",
	  "Salesforce":"integration-salesforce",
	  "Customer.io":"integration-customerio",
	  "Help Scout":"integration-help-scout",
	  "Intercom":"integration-intercom",
	  "Iterable":"integration-iterable",
	  "Librato":"integration-librato",
	  "trak.io":"integration-trak.io",
	  "Natero":"integration-natero",
	  "Knowtify":"integration-knowtify",
	  "Lytics":"integration-lytics",
	  "ActiveCampaign":"integration-activecampaign",
	  "Promoter.io":"integration-promoter.io",
	  "Nanigans":"integration-nanigans",
	  "All Aboard":"integration-all-aboard",
	  "Mixpanel":"integration-mixpanel",
	  "Amplitude":"integration-amplitude",
	  "Sentry":"integration-sentry",
	  "Boomtrain":"integration-boomtrain",
	  "Interana":"integration-interana",
	  "AutopilotHQ":"integration-autopilothq",
	  "sendinblue":"integration-sendinblue",
	  "Akita":"integration-akita",
	  "Branch Metrics":"integration-branch-metrics",
	  "BIME":"integration-bime",
	  "StreetHawk":"integration-streethawk",
	  "Amazon S3":"integration-amazon-s3",
	  "Mouseflow":"integration-mouseflow",
	  "Wigzo":"integration-wigzo",
	  "Goedle":"integration-goedle",
	  "Callexa":"integration-callexa",
	  "Zenit":"integration-zenit",
	  "Churnspotter":"integration-churnspotter",
	  "Facebook Pixel":"integration-facebook-pixel",
	  "Mojn":"integration-mojn",
	  "EngagementLogic":"integration-engagement-logic",
	  "Wootric":"integration-wootric",
	  "Tractionboard":"integration-tractionboard",
	  "MaestroIQ":"integration-maestroiq",
	  "Castle":"integration-castle",
	  "Threads":"integration-threads",
	  "Kochava":"integration-kochava",
	  "Pointillist":"integration-pointillist",
	  "tray.io":"integration-tray.io",
	  "Wagon":"integration-wagon",
	  "Interstate Analytics":"integration-interstate-analytics",
	  "Drift":"integration-drift",
	  "Smyte":"integration-smyte",
	  "Primer":"integration-primer",
	  "Zaius":"integration-zaius",
	  "Leanplum":"integration-leanplum",
	  "SparkPage":"integration-sparkpage",
	  "OneSignal":"integration-onesignal",
	  "Chartbeat":"integration-chartbeat",
	  "Relay":"integration-relay",
	  "Watsi":"integration-watsi",
	  "Adobe Marketing Cloud":"integration-adobe-marketing-cloud",
	  "LeadBoxer":"integration-leadboxer",
	  "Adjust":"integration-adjust",
	  "Freshsales":"integration-freshsales",
	  "Indicative":"integration-indicative",
	  "Sherlock":"integration-sherlock",
	  "Madkudu":"integration-madkudu",
	  "CleverTap":"integration-clevertap",
	  "Urban Airship":"integration-urban-airship",
	  "Chameleon":"integration-chameleon",
	  "Hull":"integration-hull",
	  "Klaviyo":"integration-klaviyo",
	  "Rollbar":"integration-rollbar",
	  "comScore":"integration-comscore",
	  "Facebook App Events":"integration-facebook-app-events",
	  "SatisMeter":"integration-satismeter",
	  "Webhooks":"integration-webhooks",
	  "Bluecore":"integration-bluecore",
	  "Pendo":"integration-pendo",
	  "Wishpond":"integration-wishpond",
	  "Intellimize":"integration-intellimize",
	  "FullProfile":"integration-fullprofile",
	  "Clearbit":"integration-clearbit",
	  "Kahuna":"integration-kahuna",
	  "Adobe Analytics":"integration-adobe-analytics",
	  "Countly":"integration-countly",
	  "Ask Nicely":"integration-ask-nicely",
	  "Attune":"integration-attune",
	  "Criteo":"integration-criteo",
	  "Slack":"integration-slack",
	  "TUNE":"integration-tune",
	  "Firebase":"integration-firebase",
	  "RadiumOne Connect":"integration-radiumone-connect",
	  "AppsFlyer":"integration-appsflyer"
	}
	var randomProperty = function (obj) {
	    var keys = Object.keys(obj)
	    return obj[keys[ keys.length * Math.random() << 0]].slice(12);
	};


window.onload = function(){

	function drawPoint(angle,distance,label){
		var radius = H/2-40;
		var point_size = 5;
		var font_size = "20px";
		var center_x = W / 2 - drawing.width / 2;
		var center_y = H / 2 - drawing.height / 2;
	    var x = center_x + radius * Math.cos(-angle*Math.PI/180) * distance;
	    var y = center_y + radius * Math.sin(-angle*Math.PI/180) * distance;
	    var icon = new Image();
	    switch(label){
	    	case "Warehouse":
	    		icon.src = "https://static.segment.com/site-public/2.66.17-128-g0faa301/files/icon-small-warehouses-a8ce591913.svg";
	    		line=new Line(x,y,center_x,center_y);
	    		line.drawWithArrowheads(ctx);
	    		break;
	    	case "Mobile":
	    		icon.src = "https://static.segment.com/site-public/2.66.17-128-g0faa301/files/icon-large-mobile-green-19f02e1de1.svg"
	    		line=new Line(center_x,center_y,x,y);
	    		line.drawWithArrowheads(ctx);
	    		break
	    	case "Web":
	    		icon.src = "https://static.segment.com/site-public/2.66.17-128-g0faa301/files/icon-large-web-green-8aa0bad283.svg"
	    		line=new Line(center_x,center_y,x,y);
	    		line.drawWithArrowheads(ctx);
	    		break
	    	case "Server":
	    		icon.src = "https://static.segment.com/site-public/2.66.17-128-g0faa301/files/icon-large-servers-green-7f60cbc9ea.svg"
	    		line=new Line(center_x,center_y,x,y);
	    		line.drawWithArrowheads(ctx);
	    		break
	    	default:
	    		icon.src = "https://d3hotuclm6if1r.cloudfront.net/logos/"+label+"-default.svg"
	    		line=new Line(x,y,center_x,center_y);
	    		line.drawWithArrowheads(ctx);
	    }
	    icon.onload= function(){
    		ctx.drawImage(icon,x-10*icon.width/icon.height,y-13,20*icon.width/icon.height,20);
	    };
	    icon.onerror=function(){
			ctx.strokeStyle="#00386C";
		   	ctx.fillStyle="#00386C";
		    ctx.beginPath();
		    ctx.arc(x, y, point_size, 0, 2 * Math.PI);
		    ctx.fill();
		 	ctx.font = font_size;
		    ctx.fillText(label,x + 10,y);
	    }
    	ctx.beginPath();
		ctx.arc(center_x, center_y, (drawing.height*Math.sqrt(2))/2, 0, 2 * Math.PI);
		ctx.fillStyle="#FBFAF9";
		ctx.fill();
		ctx.strokeStyle="#FBFAF9";
		ctx.stroke();

	}
	function Line(x1,y1,x2,y2){
            this.x1=x1;
            this.y1=y1;
            this.x2=x2;
            this.y2=y2;
        }
    Line.prototype.drawWithArrowheads=function(ctx){

        ctx.strokeStyle="#00386C";
    	ctx.fillStyle="#00386C";
        // draw the line
        ctx.beginPath();
        ctx.moveTo(this.x1,this.y1);
        ctx.lineTo(this.x2,this.y2);
        ctx.stroke();

        // draw the starting arrowhead
        var startRadians=Math.atan((this.y2-this.y1)/(this.x2-this.x1));
        startRadians+=((this.x2>=this.x1)?-90:90)*Math.PI/180;
        this.drawArrowhead(ctx,this.x1,this.y1,startRadians);
        // draw the ending arrowhead

    }
    Line.prototype.drawArrowhead=function(ctx,x,y,radians){
        ctx.save();
        ctx.beginPath();
        ctx.translate(x,y);
        ctx.rotate(radians);
        ctx.moveTo(0,0);
        ctx.lineTo(5,20);
        ctx.lineTo(-5,20);
        ctx.closePath();
        ctx.restore();
        ctx.fill();
    }
	
	function add_tech()
	{
		ctx.strokeStyle="#00386C";
    	ctx.fillStyle="#00386C";
		var count = 1;
		var theta = 180 / (tech.length+1);
    	var angle = theta * count;
		tech.forEach(function(entry) {
    		console.log(entry);
    		angle = theta * count
    		drawPoint(angle,1,entry);
    		count ++;
		});

	}
	function add_sources()
	{
		ctx.strokeStyle="#00386C";
    	ctx.fillStyle="#00386C";
		var count = 1;
		var theta = 180 / (sources.length+1);
    	var angle = theta * count;
		sources.forEach(function(entry) {
    		console.log(entry);
    		angle = theta * count
    		drawPoint(180+angle,1,entry);
    		count ++;
		});

	}
	var canvas = document.getElementById("canvas");
	var ctx = canvas.getContext("2d");
	//Lets resize the canvas to occupy the full page
    ctx.lineWidth=1;
	var W = window.innerWidth;
	var H = window.innerHeight;
	canvas.width = W;
	canvas.height = H;
	var tech = [];
	var sources = ["Web","Mobile","Server"];
	random_length = Math.floor(Math.random()*15);
	for (i = 0; i < random_length; i++) { 
    	new_tech = randomProperty(integrations);
    	if (tech.indexOf(new_tech) == -1){
    		tech.push(new_tech);
    	}
	}
	ctx.fillStyle = "#FBFAF9";
	ctx.fillRect(0, 0, W, H);
	var drawing = new Image();
	drawing.src = "Segment_icon.png";
	drawing.onload = function() {
   		ctx.drawImage(drawing, W / 2 - drawing.width / 2,
        H / 2 - drawing.height / 2);
	};
	drawPoint(0,1,"Warehouse");
	add_tech();
	add_sources();
}

  </script>
	
</body>      